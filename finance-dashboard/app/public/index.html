<!DOCTYPE html>

<html lang="ru">

<head>

  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="theme-color" content="#ffffff">
  <meta name="apple-mobile-web-app-title" content="Финансы">

  <title>Финансовый дашборд</title>

  <link rel="stylesheet" href="style.css">

  <link rel="manifest" href="/manifest.webmanifest">

  <link rel="apple-touch-icon" sizes="180x180" href="/180.png">

  <link rel="icon" type="image/png" sizes="192x192" href="/192.png">

  <link rel="icon" type="image/png" sizes="512x512" href="/512.png">

  <link rel="shortcut icon" href="/192.png">

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>

  <script src="i18n-core.js"></script>

  <script src="app.js" defer></script>

</head>

<body>

  <div class="container">

    <header class="topbar">

      <h1>Финансовый дашборд</h1>

      <button id="settings-btn" class="icon-btn" aria-label="Настройки">

        <svg version="1.0" xmlns="http://www.w3.org/2000/svg"

          width="1280.000000pt" height="1278.000000pt" viewBox="0 0 1280.000000 1278.000000"

          preserveAspectRatio="xMidYMid meet">

          <g transform="translate(0.000000,1278.000000) scale(0.100000,-0.100000)"

          fill="#000000" stroke="none">

          <path d="M7235 12766 c-16 -8 -42 -26 -56 -42 -14 -16 -153 -267 -309 -559

-156 -291 -298 -553 -316 -582 -53 -84 -49 -83 -328 -94 l-247 -11 -53 26

c-53 26 -59 34 -416 549 -200 287 -373 536 -386 553 -29 39 -80 64 -132 64

-43 0 -1174 -376 -1213 -403 -58 -41 -70 -89 -59 -235 24 -296 71 -892 81

-1029 l12 -153 -29 -57 c-28 -55 -38 -64 -234 -200 -113 -78 -221 -147 -240

-153 -82 -24 -92 -21 -736 246 -661 274 -642 267 -720 232 -38 -18 -781 -942

-796 -990 -8 -29 -8 -48 0 -77 8 -25 152 -223 402 -552 338 -446 391 -521 401

-564 14 -65 14 -65 -116 -375 -115 -277 -141 -316 -219 -344 -23 -8 -324 -66

-671 -128 -660 -118 -663 -119 -707 -179 -52 -70 -181 -1268 -139 -1293 6 -4

293 -110 637 -236 344 -126 640 -238 657 -248 66 -38 81 -81 141 -413 31 -169

56 -328 56 -355 0 -31 -9 -65 -23 -91 -15 -29 -167 -177 -492 -479 -259 -240

-479 -451 -490 -467 -13 -21 -19 -47 -18 -81 0 -46 25 -97 255 -544 141 -271

268 -506 283 -522 14 -15 45 -33 68 -39 39 -11 87 -2 667 129 654 148 677 151

750 117 39 -19 504 -499 532 -549 38 -70 36 -90 -66 -488 -235 -917 -230 -897

-217 -940 6 -22 22 -51 34 -65 12 -14 242 -149 511 -300 443 -249 494 -275

535 -275 27 0 59 8 76 18 17 11 230 222 475 471 245 249 461 461 482 471 73

39 93 37 459 -45 189 -42 355 -83 368 -92 69 -45 73 -54 286 -694 201 -603

207 -619 245 -653 22 -20 55 -38 77 -42 91 -17 658 19 1020 65 164 21 199 38

227 113 9 24 75 322 146 662 86 406 137 630 149 650 39 62 68 77 373 193 329

126 371 135 444 96 18 -10 248 -191 510 -403 263 -212 491 -393 508 -403 22

-13 45 -17 83 -14 51 3 62 11 349 228 583 441 638 484 657 511 11 14 22 48 24

75 5 44 -15 102 -227 658 -128 336 -235 626 -237 645 -10 69 13 112 173 332

86 117 166 224 178 236 35 39 95 65 151 64 27 0 326 -30 663 -67 l612 -66 43

19 c23 11 50 28 60 39 14 16 364 954 422 1131 22 65 8 120 -43 172 -20 21

-268 208 -551 416 -508 373 -514 378 -539 433 l-25 55 12 215 c16 281 18 294

55 348 30 43 53 56 613 337 321 161 590 299 599 306 22 19 54 85 54 112 0 42

-259 1217 -275 1248 -9 17 -32 41 -53 55 -42 27 1 24 -1013 89 -389 25 -396

27 -455 83 -43 41 -223 380 -230 434 -4 27 0 60 8 84 8 22 162 289 342 593

314 528 328 554 328 602 -1 27 -7 60 -14 74 -13 25 -850 884 -898 921 -15 12

-45 21 -80 23 l-57 4 -564 -313 c-310 -172 -582 -319 -604 -327 -69 -24 -114

-9 -300 95 -188 105 -208 120 -237 177 -26 50 -25 37 -49 751 -20 590 -21 611

-43 655 -37 75 36 53 -984 296 -172 40 -323 74 -335 74 -12 -1 -35 -7 -52 -14z

m-385 -2650 c275 -36 503 -87 740 -166 1259 -416 2223 -1500 2484 -2792 57

-283 70 -419 70 -748 1 -310 -4 -386 -45 -635 -192 -1169 -955 -2197 -2024

-2725 -405 -200 -755 -305 -1245 -372 -153 -21 -711 -17 -880 5 -874 119

-1636 499 -2230 1113 -849 878 -1212 2088 -990 3300 146 797 579 1558 1196

          2103 609 537 1352 856 2169 930 151 14 608 6 755 -13z"/>

          </g>

        </svg>

      </button>

    </header>

    <nav class="nav-tabs" aria-label="Основная навигация" role="tablist">

      <button class="nav-tab active" data-view="transactions" role="tab" aria-selected="true">Транзакции</button>

      <button class="nav-tab" data-view="stats" role="tab" aria-selected="false">Статистика</button>

      <button class="nav-tab" data-view="summary" role="tab" aria-selected="false">Итоги</button>

    </nav>



    <main class="main">

      <section id="transactions-view" class="view-section active" aria-labelledby="transactions-title">

        <div class="toolbar transactions-toolbar">

          <div class="segmented">

            <button id="exp" class="btn base active">Расходы</button>

            <button id="inc" class="btn base">Доходы</button>

          </div>

          <div class="view-toggle">

            <span class="muted">Вид:</span>

            <button id="view-list" class="btn toggle active">Таблица</button>

            <button id="view-cards" class="btn toggle">Карточки</button>

          </div>

          <button id="add-btn" class="btn primary">Добавить расход</button>

        </div>



        <details>

          <summary>Фильтры</summary>

          <div class="filters">

            <label>Категория

              <select id="flt-category"><option value="">Все</option></select>

            </label>

            <label>Валюта

              <select id="flt-currency"><option value="">Все</option></select>

            </label>

            <label>Кто

              <select id="flt-who"><option value="">Все</option></select>

            </label>

            <label>Дата с

              <input type="datetime-local" id="flt-date-from" />

            </label>

            <label>Дата по

              <input type="datetime-local" id="flt-date-to" />

            </label>

            <div class="actions">

              <button type="button" id="flt-apply" class="btn">Применить</button>

              <button type="button" id="flt-reset" class="btn">Сбросить</button>

            </div>

          </div>

        </details>



        <div class="quick-periods" id="quick-periods">

          <button type="button" class="btn period" id="period-today">Сегодня</button>

          <button type="button" class="btn period" id="period-week">Последние 7 дней</button>

          <button type="button" class="btn period" id="period-month">Последние 30 дней</button>

        </div>



        <div class="table-wrap">

          <table id="records"></table>

        </div>



        <div class="cards-grid" id="cards"></div>



        <div class="pager">

          <div class="pager-left">

            Показывать по:

            <select id="page-size">

              <option value="20" selected>20</option>

              <option value="50">50</option>

              <option value="100">100</option>

              <option value="all">Все</option>

            </select>

          </div>

          <div class="pager-right">

            <button class="btn" id="prev-page">Назад</button>

            <span id="page-info" class="muted">Стр. 1</span>

            <button class="btn" id="next-page">Вперед</button>

          </div>

        </div>

      </section>



      <section id="stats-view" class="view-section" aria-labelledby="stats-title">

        <div class="panel">

          <div class="panel-header">

            <div>

              <h2 id="stats-title">Статистика расходов</h2>

              <p class="muted">Используются значения поля «Сумма в долларах»</p>

            </div>

            <div class="period-buttons">

              <button class="btn period active" data-stats-period="this_month">Этот месяц</button>

              <button class="btn period" data-stats-period="last_month">Прошлый месяц</button>

              <button class="btn period" data-stats-period="custom">Период…</button>

            </div>

          </div>



          <div class="custom-range" id="stats-range">

            <label>От

              <input type="month" id="stats-from" />

            </label>

            <label>До

              <input type="month" id="stats-to" />

            </label>

            <button type="button" class="btn primary" id="stats-apply">Показать</button>

          </div>



          <div id="stats-loading" class="placeholder muted" hidden>Загрузка…</div>

          <div id="categories-empty" class="placeholder" hidden>Нет данных за выбранный период</div>



          <div class="chart-card">

            <canvas id="categories-chart" aria-label="Диаграмма расходов по категориям"></canvas>

          </div>



          <ul id="categories-breakdown" class="stats-breakdown"></ul>

        </div>

      </section>



      <section id="summary-view" class="view-section" aria-labelledby="summary-title">

        <div class="panel">

          <div class="panel-header">

            <div>

              <h2 id="summary-title">Итоги</h2>

              <p class="muted" id="summary-period-label"></p>

            </div>

            <div class="period-buttons">

              <button class="btn period active" data-summary-period="this_month">Этот месяц</button>

              <button class="btn period" data-summary-period="last_month">Прошлый месяц</button>

              <button class="btn period" data-summary-period="all">Все время</button>

              <button class="btn period" data-summary-period="custom">Период…</button>

            </div>

          </div>



          <div class="custom-range" id="summary-range">

            <label>От

              <input type="month" id="summary-from" />

            </label>

            <label>До

              <input type="month" id="summary-to" />

            </label>

            <button type="button" class="btn primary" id="summary-apply">Показать</button>

          </div>



          <div id="summary-loading" class="placeholder muted" hidden>Загрузка…</div>

          <div id="summary-empty" class="placeholder" hidden>Нет данных за выбранный период</div>



          <div class="summary-grid">

            <article class="summary-card spend">

              <h3>Потрачено</h3>

              <p class="summary-value" id="summary-expenses-amount">0 $</p>

              <p class="muted" id="summary-expenses-meta"></p>

            </article>

            <article class="summary-card earn">

              <h3>Заработано</h3>

              <p class="summary-value" id="summary-income-amount">0 $</p>

              <p class="muted" id="summary-income-meta"></p>

            </article>

            <article class="summary-card balance">

              <h3>Баланс</h3>

              <p class="summary-value" id="summary-balance-amount">0 $</p>

              <p class="muted" id="summary-balance-meta"></p>

            </article>

          </div>

        </div>

      </section>

    </main>

  </div>



  <div id="modal" role="dialog" aria-modal="true">

    <div class="modal-card" id="modal-card">

      <h3 id="modal-title">Добавление расхода</h3>

      <form id="edit-form" class="form">

        <label>Описание

          <input type="text" id="f-description" placeholder="Например, кофе" />

        </label>

        <label id="field-category">Категория

          <select id="f-categories"></select>

        </label>

        <label>Сумма

          <input type="number" step="0.01" id="f-amount" />

        </label>

        <label>Валюта

          <select id="f-currency"></select>

        </label>

        <label>Дата и время

          <input type="datetime-local" id="f-date" />

        </label>

        <label>Кто

          <input type="text" id="f-who" placeholder="Имя" />

        </label>

        <div class="readonly-field">

          <label>Сумма в долларах</label>

          <div id="f-usd-display" class="readonly-box">-</div>

        </div>

        <div class="actions">

          <button type="submit" id="save-btn" class="btn primary">Сохранить</button>

          <button type="button" id="delete-btn" class="btn danger">Удалить</button>

          <button type="button" id="cancel-btn" class="btn">Отмена</button>

          <span id="status" class="muted"></span>

        </div>

      </form>

    </div>

  </div>



  <div id="details-modal" role="dialog" aria-modal="true" class="modal" style="display:none;">

    <div class="modal-card">

      <h3>Подробности</h3>

      <div id="details-content" class="details-content"></div>

      <div class="actions">

        <button type="button" class="btn" id="details-edit">Редактировать</button>

        <button type="button" class="btn" id="details-close">Закрыть</button>

      </div>

    </div>

  </div>



  <div id="settings-modal" role="dialog" aria-modal="true" class="modal" style="display:none;">

    <div class="modal-card settings-card">

      <h3>Настройки</h3>



      <div class="settings-tabs">

        <div class="settings-tab-headers" role="tablist" aria-label="Настройки">

          <button class="settings-tab active" data-tab="profile" role="tab" aria-selected="true">

            <svg class="tab-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 12c2.7 0 5-2.3 5-5s-2.3-5-5-5-5 2.3-5 5 2.3 5 5 5zm0 2c-3.3 0-10 1.7-10 5v3h20v-3c0-3.3-6.7-5-10-5z"/></svg>

            <span class="tab-label">Профиль</span>

          </button>

          <button class="settings-tab" data-tab="categories" role="tab" aria-selected="false">

            <svg class="tab-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"/></svg>

            <span class="tab-label">Категории</span>

          </button>

          <button class="settings-tab" data-tab="currencies" role="tab" aria-selected="false">

            <span class="tab-icon" aria-hidden="true">$</span>

            <span class="tab-label">Валюты</span>

          </button>

          <button class="settings-tab" data-tab="backups" role="tab" aria-selected="false">

            <svg class="tab-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 18H6a4 4 0 0 1 0-8 5 5 0 0 1 9.9-1.5A4 4 0 0 1 19 18zm-7-5v4l3-2-3-2z"/></svg>

            <span class="tab-label">Резервные копии</span>

          </button>

        </div>



        <div class="settings-tab-panels">

          <div class="settings-panel active" data-tab="profile" role="tabpanel">

            <div class="settings-section">

              <h4>Профиль</h4>

              <label>Имя по умолчанию

                <input type="text" id="default-who-input" placeholder="Например, Алексей" />

              </label>

              <label>Язык

                <select id="settings-language">

                  <option value="en">English</option>

                  <option value="ru">Русский</option>

                </select>

              </label>

              <label>Тип диаграммы статистики

                <select id="settings-chart-type">

                  <option value="pie">Круговая диаграмма</option>

                  <option value="bar">Столбчатая диаграмма</option>

                </select>

              </label>

              <label class="settings-checkbox" style="margin-top:8px;">

                <input id="notifyToggle" type="checkbox" />

                <span id="notify-label">Уведомления</span>

              </label>

            </div>

          </div>



          <div class="settings-panel" data-tab="categories" role="tabpanel" hidden>

            <div class="settings-section">

              <h4>Категории</h4>

              <form id="category-form" class="settings-inline-form">

                <input type="text" id="new-category-input" placeholder="Новая категория" />

                <button type="submit" class="btn secondary">Добавить</button>

              </form>

              <ul id="settings-category-list" class="settings-list"></ul>

            </div>

          </div>



          <div class="settings-panel" data-tab="currencies" role="tabpanel" hidden>

            <div class="settings-section">

              <h4>Валюты</h4>

              <form id="currency-form" class="settings-inline-form">

                <input type="text" id="new-currency-input" placeholder="Код валюты (например, USD)" />

                <input type="number" id="new-currency-rate-input" class="currency-rate-input" step="0.000001" min="0" placeholder="Курс к USD" />

                <button type="submit" class="btn secondary">Добавить</button>

              </form>

              <ul id="settings-currency-list" class="settings-list"></ul>

            </div>

          </div>



          <div class="settings-panel" data-tab="backups" role="tabpanel" hidden>

            <div class="settings-section">

              <h4>Резервные копии</h4>

              <p id="backup-script-hint" class="settings-hint">URL вебхука настраивается в конфигурации аддона Home Assistant.</p>

              <label class="settings-field" for="backup-run-time">

                <span>Время запуска</span>

                <input type="time" id="backup-run-time" class="settings-time-input" />

              </label>

              <label class="settings-checkbox">

                <input type="checkbox" id="backup-auto-toggle" />

                <span id="backup-auto-label">Включить автоматические резервные копии</span>

              </label>

              <div class="backup-controls">

                <button type="button" class="btn secondary" id="backup-refresh">Обновить список</button>

                <button type="button" class="btn primary" id="backup-run">Создать копию сейчас</button>

              </div>

              <div id="backup-last-run" class="backup-last-run">Автокопирование пока не настроено</div>

              <div id="backup-status" class="settings-status" hidden></div>

              <div id="backup-list" class="backup-list"></div>

            </div>

          </div>

        </div>

      </div>



      <div class="settings-actions">

        <button type="button" class="btn primary" id="settings-save">Сохранить</button>

        <button type="button" class="btn" id="settings-cancel">Закрыть</button>

        <button type="button" class="btn link" id="settings-logout">Выйти</button>

      </div>

    </div>

  </div>



  <button id="fab-add" class="fab" aria-label="Добавить запись">+</button>



</body>

</html>



